<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AVALIA NR01 — Login</title>
  <link rel="stylesheet" href="assets/branding.css">
</head>
<body>

<nav>
  <div class="logo" style="justify-content: space-between;">
    <div style="display:flex; align-items:center; gap:10px;">
      <img src="assets/datainsight.png"
           style="height:40px; width:auto; transform:rotate(-90deg); object-fit:contain;">
      <span>Datainsight Consulting</span>
    </div>
    <span class="small" style="opacity:.75;">AVALIA NR01 · Painel Corporativo</span>
  </div>
</nav>

<div class="container">
  <div class="card auth-card auth-container">
    <h2>Acesso Empresarial</h2>
    <p class="small">
      Entre com suas credenciais para acessar os relatórios e indicadores psicossociais da sua empresa.
    </p>

    <label class="small" for="email">Usuário (e-mail)</label>
    <input id="email" placeholder="seu@email.com" type="email" autocomplete="username">

    <div style="height:10px"></div>

    <label class="small" for="password">Senha</label>
    <input id="password" placeholder="Sua senha" type="password" autocomplete="current-password">

    <button class="btn" style="margin-top:16px; width:100%;" onclick="doLogin()">Entrar</button>

    <p class="small" style="margin-top:14px; text-align:center;">
      Não tem conta? <a href="register.html" style="color:#7dd3fc; text-decoration:none;">Cadastre-se</a>
    </p>
  </div>
</div>

<div class="footer">
  © 2025 AVALIA NR01 — Conformidade NR-01/NR-17 |
  <a href="#" onclick="localStorage.clear();alert('Sessão limpa.');" style="color:#7dd3fc;">Limpar sessão</a>
</div>

<script>
async function doLogin() {
  const emailEl = document.getElementById('email');
  const passEl  = document.getElementById('password');

  const res = await fetch('/api/login', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({
      email: emailEl.value,
      password: passEl.value
    })
  });

  if (!res.ok) {
    alert('Falha no login');
    return;
  }

  const data = await res.json();
  localStorage.setItem('token', data.token);
  location.href = 'dashboard.html';
}
</script>

</body>
</html>

