<!doctype html><html lang="pt-BR"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>AVALIA NR01 — Dashboard</title>
<link rel="stylesheet" href="assets/branding.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head><body>
<nav><div class="wrap"><div class="logo"><img src="assets/logo.svg"><span>AVALIA NR01</span></div>
<div style="margin-left:auto"><a class="btn secondary" href="campaigns.html">Campanhas</a> <a class="btn secondary" href="report.html">Relatórios</a></div></div></nav>
<div class="container">
  <div class="card"><h2>Visão Geral</h2>
    <div class="grid">
      <div class="col-6"><canvas id="radar"></canvas></div>
      <div class="col-6"><div id="actions"></div></div>
    </div>
  </div>
</div>
<div class="footer">© 2025 AVALIA NR01</div>
<script>
let token = localStorage.getItem('token'); if(!token) location.href='index.html';
async function load(){
  const camps = await fetch('/api/campaigns',{headers:{Authorization:'Bearer '+token}}).then(r=>r.json());
  if(!camps.length){ document.getElementById('actions').innerHTML='<p class="small">Crie uma campanha em <b>Campanhas</b>.</p>'; return;}
  const sum = await fetch('/api/summary/'+camps[0].id,{headers:{Authorization:'Bearer '+token}}).then(r=>r.json());
  const labels = Object.keys(sum.average);
  const data = Object.values(sum.average);
  new Chart(document.getElementById('radar'),{type:'radar', data:{labels:labels, datasets:[{label:'Média (1-5)', data:data}]}});
  const list = sum.actions.map(a=>'<div class="card"><span class="badge">'+a.priority+'</span> <b>'+a.dimension+'</b><br><span class="small">'+a.suggestion+'</span></div>').join('');
  document.getElementById('actions').innerHTML=list || '<p class="small">Sem dados ainda.</p>';
}
load();
</script>
</body></html>